<!-- استایل گرافیکی -->
<style>
  body {
    font-family: 'Vazirmatn', sans-serif;
    background: linear-gradient(135deg, #ece9e6, #ffffff);
    display: flex; justify-content: center; align-items: center;
    height: 100vh; margin: 0;
  }

  .form-container {
    background: rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    backdrop-filter: blur(8px);
    border-radius: 15px;
    padding: 20px;
    width: 90%;
    max-width: 400px;
  }

  input, textarea {
    width: 100%;
    margin-bottom: 15px;
    padding: 10px;
    border-radius: 10px;
    border: none;
    box-shadow: inset 2px 2px 5px #aaa, inset -2px -2px 5px #fff;
    font-size: 14px;
    transition: box-shadow 0.3s ease;
  }

  input:focus, textarea:focus {
    box-shadow: 0 0 10px #00c6ff;
    outline: none;
  }

  button {
    background: #00c6ff;
    color: white;
    padding: 10px;
    width: 100%;
    border: none;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(0, 198, 255, 0.5);
    transition: all 0.3s ease;
  }

  button:hover {
    background: #009ddc;
    box-shadow: 0 6px 20px rgba(0, 157, 220, 0.6);
  }
</style>

<!-- فرم HTML -->
<div class="form-container">
  <input id="token" placeholder="توکن بات">
  <input id="chatid" placeholder="شناسه چت">
  <textarea id="message" placeholder="پیام"></textarea>
  <input id="repeat" type="number" min="1" max="100" placeholder="تعداد تکرار">
  <button onclick="sendMessage()">بفرست 🚀</button>
</div>

<!-- صدای موفقیت -->
<audio id="success-sound" src="https://orangefreesounds.com/wp-content/uploads/2024/08/Success-notification-tone.mp3"></audio>

<!-- اسکریپت کامل -->
<script>
  document.querySelectorAll("input, textarea").forEach(el => {
    el.addEventListener("focus", () => {
      el.scrollIntoView({ behavior: "smooth", block: "center" });
    });
  });

  function showNotification(msg) {
    alert(msg); // می‌تونی با toast یا modal جایگزینش کنی
  }

  function playSound() {
    document.getElementById("success-sound").play();
  }

  function sendMessage() {
    const token = document.getElementById("token").value;
    const chatid = document.getElementById("chatid").value;
    const msg = document.getElementById("message").value;
    const repeat = parseInt(document.getElementById("repeat").value);

    if (!token || !chatid || !msg || isNaN(repeat) || repeat <= 0) {
      showNotification("فیلدها را درست پر کن 😅");
      return;
    }

    let count = 0;
    function loopSend() {
      fetch(`https://api.telegram.org/bot${token}/sendMessage?chat_id=${chatid}&text=${encodeURIComponent(msg)}`)
        .then(res => res.json())
        .then(data => {
          count++;
          if (data.ok) {
            playSound();
            console.log(`✅ پیام ${count} ارسال شد`);
          } else {
            console.log(`❌ پیام ${count} خطا: ${data.description}`);
          }
          if (count < repeat) {
            loopSend();
          } else {
            showNotification("همه پیام‌ها رفتن 🎉");
          }
        })
        .catch(() => {
          showNotification("خطای شبکه یا توکن اشتباهه 😬");
        });
    }

    loopSend();
  }
</script>
